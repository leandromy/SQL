-- DMFinanceiro.VW_CONSULTA_RENEGOCIACAO source

CREATE view [DMFinanceiro].[VW_CONSULTA_RENEGOCIACAO]
as
	SELECT
		'F_RENEGOCIACAO' AS TABLE_NAME,
		A.NUMERO_CONTRATO,
		A.NUMERO_PARCELA,
		A.CODIGO_RENEGOCIACAO,
		A.DATA_GERACAO_RENEGOCIACAO,
		A.DATA_VENCIMENTO,
		A.VALOR_CORRIGIDO,
		A.VALOR_QUITACAO,
		B.CLIENTE,
		C.CODIGO_EMPREENDIMENTO,
		C.NOME_FILIAL,
		D.DESC_TIPO_PARCELA,
		E.CODIGO_REDUZIDO_PROJETO,
		F.DESC_STATUS_RENEGOCIACAO,
		G.OBSERVACAO,
		H.SITUACAO_RENEGOCIACAO
	FROM DMFinanceiro.F_RENEGOCIACAO A
	LEFT JOIN DMGeral.D_CLIENTE B 
		ON B.SK_D_CLIENTE = A.SK_D_CLIENTE
	LEFT JOIN DMGeral.D_EMPREENDIMENTO C 
		ON C.SK_D_EMPREENDIMENTO = A.SK_D_EMPREENDIMENTO
	LEFT JOIN DMFinanceiro.D_TIPO_PARCELA D 
		ON D.SK_D_TIPO_PARCELA = A.SK_D_TIPO_PARCELA
	LEFT JOIN DMGeral.D_PROJETO E 
		ON E.SK_D_PROJETO = A.SK_D_PROJETO
	LEFT JOIN DMFinanceiro.D_STATUS_RENEGOCIACAO F
		ON F.SK_D_STATUS_RENEGOCIACAO = A.SK_D_STATUS_RENEGOCIACAO
	LEFT JOIN DMFinanceiro.D_RENEGOCIACAO_OBSERVACAO G
		ON G.SK_D_RENEGOCIACAO_OBSERVACAO = A.SK_D_RENEGOCIACAO_OBSERVACAO
	LEFT JOIN DMFinanceiro.D_SITUACAO_RENEGOCIACAO H 
		ON H.SK_D_SITUACAO_RENEGOCIACAO = A.SK_D_SITUACAO_RENEGOCIACAO;
